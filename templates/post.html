{% extends "base.html" %}
{% block main %}

<div class="page-grid">
  <!-- Title & meta span both columns so they feel centered -->
  <header class="article" style="grid-column: 2 / span 2;">
    <h1>{{ post.title }}</h1>
    <p class="muted">{{ post.date }}{% if post.tags %} · {{ post.tags|join(", ") }}{% endif %}</p>
  </header>

  {% for s in post.sections %}
    {% if s.type == "p" %}
      <p class="article">{{ s.text }}</p>

    {% elif s.type == "html" %}
      <div class="article">{{ s.html | safe }}</div>

    {% elif s.type == "expander_html" %}
      {% set id = "exp-" ~ loop.index %}
      <button class="expander article" aria-expanded="false" aria-controls="{{ id }}">
        <span class="chevron" aria-hidden="true">▸</span>
        <span class="sr-only">{{ s.label or "Show more" }}</span>
      </button>
      <div id="{{ id }}" class="expando article" hidden>
        {{ s.html | safe }}
      </div>

    {% elif s.type == "note" %}
      <aside class="marginalia marginalia--box">
        {{ s.text }}
      </aside>

    {% elif s.type == "note_html" %}
      <aside class="marginalia marginalia--box">
        {{ s.html | safe }}
      </aside>

    {% elif s.type == "note_image" %}
      <aside class="marginalia">
        {% if s.caption %}<div class="marginalia--box">{{ s.caption }}</div>{% endif %}
        <img src="{{ base }}/static/{{ s.src }}" alt="{{ s.alt or '' }}">
      </aside>

    {% endif %}
  {% endfor %}
</div>

{% endblock %}
