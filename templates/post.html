{% extends "base.html" %}
{% block main %}
<article class="post">
  <h1>{{ post.title }}</h1>
  <p class="muted">{{ post.date }}{% if post.tags %} · {{ post.tags|join(", ") }}{% endif %}</p>

  {% for s in post.sections %}
    {% if s.type == "p" %}
      <p>{{ s.text }}</p>

    {% elif s.type == "html" %}
      {{ s.html | safe }}

    {% elif s.type == "expander_html" %}
      {% set id = "exp-" ~ loop.index %}
      <button class="expander" aria-expanded="false" aria-controls="{{ id }}">
        <span class="chevron" aria-hidden="true">▸</span>
        <span class="sr-only">{{ s.label or "Show more" }}</span>
      </button>
      <div id="{{ id }}" class="expando" hidden>
        {{ s.html | safe }}
      </div>

    {% elif s.type == "expander" %}
      {# Back-compat if someone used 'content' string instead of an md file #}
      {% set id = "exp-" ~ loop.index %}
      <button class="expander" aria-expanded="false" aria-controls="{{ id }}">
        <span class="chevron" aria-hidden="true">▸</span>
        <span class="sr-only">{{ s.label or "Show more" }}</span>
      </button>
      <div id="{{ id }}" class="expando" hidden>
        <p>{{ s.content }}</p>
      </div>

    {% endif %}
  {% endfor %}
</article>
{% endblock %}
